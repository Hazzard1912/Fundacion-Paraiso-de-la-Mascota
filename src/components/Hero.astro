---
import { getHeroData } from "../actions/cms.actions";

// Obtener datos del hero desde Strapi
let heroData = null;
let error = null;

try {
    const result = await Astro.callAction(getHeroData, {});
    if (result.error) {
        console.error("Error fetching hero data:", result.error);
        error = result.error;
    } else if (result.data) {
        heroData = result.data;
    }
} catch (e) {
    console.error("Exception fetching hero data:", e);
    error = e;
}

// Datos por defecto en caso de error

const defaultData = {
    title: "Dale una Segunda Oportunidad",
    subtitle: "Cada mascota merece un hogar lleno de amor. Tu peque침o gesto puede cambiar una vida para siempre.",
    backgroundImage: "https://images.unsplash.com/photo-1450778869180-41d0601e046e?auto=format&fit=crop&q=80",
    alternativeText: "Imagen de fondo del hero",
};

// Usar datos de Strapi si est치n disponibles, sino usar datos por defecto
const finalData = (heroData && heroData.success && heroData.data) ? heroData.data : defaultData;
---

<section
    class="relative min-h-screen bg-gradient-to-b from-neutral-900/80 to-neutral-900/20"
    id="hero"
>
    <!-- Background Image -->
    <div class="absolute inset-0 -z-10">
        <img
            src={finalData.backgroundImage}
            alt={finalData.alternativeText || "Hero background"}
            class="w-full h-full object-cover"
        />
    </div>

    <!-- Content Container -->
    <div
        class="container mx-auto px-4 h-screen flex flex-col items-center justify-center text-white"
    >
        <!-- Main Content -->
        <div class="max-w-4xl text-center space-y-8">
            <h1
                class="text-5xl md:text-7xl font-bold leading-tight animate-fade-in"
            >
                {finalData.title.split(' ').slice(0, -1).join(' ')}
                <span class="text-amber-400">{finalData.title.split(' ').slice(-1)[0]}</span>
            </h1>

            <p class="text-xl md:text-2xl text-gray-200 max-w-2xl mx-auto">
                {finalData.subtitle}
            </p>

            <!-- Action Buttons -->
            <div class="flex flex-wrap justify-center gap-4 mt-8">
                <a
                    href="/adopta"
                    class="px-8 py-4 bg-amber-500 hover:bg-amber-600 rounded-full font-semibold text-lg transition-all transform hover:scale-105"
                >
                    Adopta Ahora
                </a>
                <a
                    href="/ayudanos#donaciones"
                    class="px-8 py-4 bg-white/10 backdrop-blur hover:bg-white/20 rounded-full font-semibold text-lg transition-all"
                >
                    Haz una Donaci칩n
                </a>
            </div>

            <!-- Stats -->
            <div class="grid grid-cols-2 md:grid-cols-3 gap-8 mt-12">
                <div class="text-center">
                    <span class="block text-4xl font-bold text-amber-400"
                        >100+</span
                    >
                    <span class="text-gray-300">Mascotas Adoptadas</span>
                </div>
                <div class="text-center">
                    <span class="block text-4xl font-bold text-amber-400"
                        >50+</span
                    >
                    <span class="text-gray-300">Voluntarios Activos</span>
                </div>
                <div class="text-center hidden md:block">
                    <span class="block text-4xl font-bold text-amber-400"
                        >10</span
                    >
                    <span class="text-gray-300">A침os de Experiencia</span>
                </div>
            </div>
        </div>
    </div>
</section>
